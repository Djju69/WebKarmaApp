?document.addEventListener("DOMContentLoaded", () => {
  // Mobile menu
  const toggle = document.querySelector(".nav-toggle");
  const header = document.querySelector(".site-header");
  toggle?.addEventListener("click", () => header?.classList.toggle("open"));

  // ?�???�?�?�?-?�?.?�?�?�?.?�?�?�?.?�?'?�?� ?�?"?�?�???,???"?????�?�?�?�?�?'
  const ADS = [
    {title:"-20% ?�?.?�?� ?�?"?�?.??????�?�", desc:"?�???�?�?�?-?�?.?�?'?�?.???? ?�?? ?'?�?�?? ?�?'???,�?�?.??????�?�?'?� ?�?'?�?. 18:00", tag:"?�?T?�?�??????�?�"},
    {title:"?�??�?�?�?????�?-?�?�?�?�??????�?.??????�?"- ?�?'?�?�?????�?�???,?????", desc:"?�?????,?�?' ?�?�?�?�?�?"?�?�?�?�?�?� ?�?.????? 800 ??????.", tag:"?�?�?�?�??????????�?.???,?�?�?�?."},
    {title:"3 ?�???�?'?�?�?�?'??????�?� = ?�?�?�?�?�?.?�?.?�?�?�?�?�?�?�?.????? -30%", desc:"?�?�?�?'??????�?.?�?�???? ?'?�?�?'??????�?�?�?�??????'?�", tag:"?�?�?�?'??????�?.?�?�????"},
    {title:"-10% ?�?'?�?�???? ?�?.?�?.?�???????????� ?�?-?�?.??????????�?�?�?"-", desc:"?'?�?�???�?�???,?�?'?�??T?�?�?�?.?�?.?�?�?'?�", tag:"?�?�?�?�??????????�?.???,?�?�?�?."},
    {title:"Happy Hours", desc:"?�?? 16:00 ?�?'?�?. 18:00", tag:"?�?T?�?�??????�?�"},
    {title:"?�?T???"?�?-?�?.?�?. -200 ??????.", desc:"?�???�?� ?�?-?�?�???,?�????????�?"- ?�?�?�?�?�?"?�?�?�?�", tag:"?�????�?.??????????�?�?�???�?"?�?�"}
  ];
  const track = document.getElementById("adsTrack");
  if (track) {
    track.innerHTML = ADS.map(a => `
      <article class="carousel-card">
        <div>
          <div class="carousel-title">${a.title}</div>
          <div class="carousel-desc">${a.desc}</div>
        </div>
        <div class="carousel-meta">
          <span style="font-size:12px;color:#6B7280">${a.tag}</span>
          <a class="btn" style="padding:6px 10px" href="/cabinet">?�???�?.?�?'???,?�?.?�?�?�?.?�?�?�?�</a>
        </div>
      </article>
    `).join("");
  }

  // ?�?T?�?.?�?.?�?-?�?"?�?' ?�?"?�?�???,???"?????�?�?�?�?�?'
  const scroller = document.getElementById("adsCarousel");
  const prev = document.querySelector('.carousel-btn[data-dir="prev"]');
  const next = document.querySelector('.carousel-btn[data-dir="next"]');
  function scrollByOne(dir=1){
    if (!track) return;
    const card = track.querySelector(".carousel-card");
    if (!card) return;
    const step = card.getBoundingClientRect().width + 16; // ???,�?�?'???,?�?'?�?.?�?� + gap
    track.scrollBy({left: step * dir, behavior: "smooth"});
  }
  prev?.addEventListener("click", ()=>scrollByOne(-1));
  next?.addEventListener("click", ()=>scrollByOne(1));

  // ?�???�???�?�?�?"-?�?- ?�?.?�?� ?�?�?�?.?�?�?�?'?�?�?�?�
  let sx=0, sl=0, dragging=false;
  track?.addEventListener("pointerdown", e=>{dragging=true; sx=e.clientX; sl=track.scrollLeft; track.setPointerCapture(e.pointerId);});
  track?.addEventListener("pointermove", e=>{ if(!dragging) return; track.scrollLeft = sl - (e.clientX - sx);});
  track?.addEventListener("pointerup",   ()=>{dragging=false});
  track?.addEventListener("pointercancel",()=>{dragging=false});
});// DASHBOARD MOBILE SIDEBAR (v2)
(function(){
  if (!document.body.classList.contains('dashboard-body')) return;

  const sidebar = document.querySelector('.sidebar');
  const topbar  = document.querySelector('.topbar');
  if (!sidebar || !topbar) return;

  // ?�?�???"???,?�?-?�?�???,-?�?"?�?.?�?.?�?-?�?"?�?� (?�?�?????�?�?�?' ?�?.?�?�????? ???,??? ?�?'?�?.?�?�?�?�?�???�?'?�?�)
  let btn = topbar.querySelector('#menuToggle');
  if (!btn){
    btn = document.createElement('button');
    btn.id = 'menuToggle';
    btn.className = 'hamburger';
    btn.setAttribute('aria-label','?�???�?�?�?.???<');
    btn.innerHTML = '<span></span>';
    topbar.prepend(btn);
  }

  // ??????�?.?�?.-?�?�?�?�?�?"?�?'???,?�?.?�?-
  let backdrop = document.querySelector('#sidebarBackdrop');
  if (!backdrop){
    backdrop = document.createElement('div');
    backdrop.id = 'sidebarBackdrop';
    backdrop.className = 'sidebar-backdrop';
    document.body.appendChild(backdrop);
  }

  const open  = ()=>{ sidebar.classList.add('open'); backdrop.classList.add('visible'); document.body.classList.add('menu-open'); };
  const close = ()=>{ sidebar.classList.remove('open'); backdrop.classList.remove('visible'); document.body.classList.remove('menu-open'); };

  btn.addEventListener('click', ()=>{ sidebar.classList.contains('open') ? close() : open(); });
  backdrop.addEventListener('click', close);

  // ?�?�?�?�?�?"???,??????�???�?�????????? ?�?-???,?�?' ?�?"?�?�?�?'?�?"?�?� ?�?-?�?. ?�?-???"?�?.?�?"??????�?�?�?� ?�?�?�?�?�?.???<
  document.querySelectorAll('.sidebar .nav-item').forEach(a=>{
    a.addEventListener('click', ()=> close());
  });

  // ESC ?�?�?�?�?�?"???,??????�???�?�?�?�?????
  document.addEventListener('keydown', e=>{ if (e.key === 'Escape') close(); });

  // ?�?-???,?�?' ???,?�?�???????,�?�?'???,?�?�?�?.?�?'?�?' ?�?.?�?"?�?.?�?� >900px ???,??? ?�?-???,?�?'?�?.???"?�?'?�?'??????�?�?�?�?????�?.?�?. ?�?�?�?�?�?"???,?????????????? ?�?�?�?.?�?�?�?'?�?�?????�?.?�?.?�?� ?�?�?�?�?�?.???<
  const applyCloseOnWide = ()=>{ if (window.innerWidth > 900) close(); };
  window.addEventListener('resize', applyCloseOnWide);
})();
